{"version":3,"file":"index.esm.js","sources":["../src/keyboard.ts","../src/mouse.ts","../src/index.ts"],"sourcesContent":["/**\n * input/keyboard - keyboard input handling\n * Part of Stardazed\n * (c) 2015-Present by Arthur Langereis - @zenmumbler\n * https://github.com/stardazed/stardazed\n */\n\nimport { UInt8, Double } from \"@stardazed/core\";\nimport { FixedMultiArray, MABField, fill } from \"@stardazed/container\";\nimport { ButtonState } from \"./common\";\n\nexport enum Key {\n\tNONE = 0,\n\n\tUP = 38,\n\tDOWN = 40,\n\tLEFT = 37,\n\tRIGHT = 39,\n\n\tBACKSPACE = 8,\n\tTAB = 9,\n\tRETURN = 13,\n\tESC = 27,\n\tSPACE = 32,\n\n\tPAGEUP = 33,\n\tPAGEDOWN = 34,\n\tHOME = 36,\n\tEND = 35,\n\tDELETE = 46,\n\n\t// charCode equals keyCode for A-Z\n\tA = \"A\".charCodeAt(0), B = \"B\".charCodeAt(0), C = \"C\".charCodeAt(0), D = \"D\".charCodeAt(0),\n\tE = \"E\".charCodeAt(0), F = \"F\".charCodeAt(0), G = \"G\".charCodeAt(0), H = \"H\".charCodeAt(0),\n\tI = \"I\".charCodeAt(0), J = \"J\".charCodeAt(0), K = \"K\".charCodeAt(0), L = \"L\".charCodeAt(0),\n\tM = \"M\".charCodeAt(0), N = \"N\".charCodeAt(0), O = \"O\".charCodeAt(0), P = \"P\".charCodeAt(0),\n\tQ = \"Q\".charCodeAt(0), R = \"R\".charCodeAt(0), S = \"S\".charCodeAt(0), T = \"T\".charCodeAt(0),\n\tU = \"U\".charCodeAt(0), V = \"V\".charCodeAt(0), W = \"W\".charCodeAt(0), X = \"X\".charCodeAt(0),\n\tY = \"Y\".charCodeAt(0), Z = \"Z\".charCodeAt(0),\n}\n\n\nexport interface Keyboard {\n\tkeyState(kc: Key): ButtonState;\n\tdown(kc: Key): boolean;\n\tpressed(kc: Key): boolean;\n\treleased(kc: Key): boolean;\n\thalfTransitions(kc: Key): number;\n\n\treset(): void;\n\tresetPerFrameData(): void;\n}\n\n\nclass KeyboardImpl implements Keyboard {\n\tprivate keyData_: FixedMultiArray;\n\tprivate downBase_: Uint8Array;\n\tprivate halfTransBase_: Uint8Array;\n\tprivate lastEventBase_: Float64Array;\n\n\tconstructor() {\n\t\tconst fields: MABField[] = [\n\t\t\t{ type: UInt8, count: 1 },  // down\n\t\t\t{ type: UInt8, count: 1 },  // halfTransitionCount\n\t\t\t{ type: Double, count: 1 }, // lastEvent\n\t\t];\n\t\tthis.keyData_ = new FixedMultiArray(128, fields);\n\t\tthis.downBase_ = this.keyData_.indexedFieldView(0) as Uint8Array;\n\t\tthis.halfTransBase_ = this.keyData_.indexedFieldView(1) as Uint8Array;\n\t\tthis.lastEventBase_ = this.keyData_.indexedFieldView(2) as Float64Array;\n\n\t\t// The extra check in the key handlers for the timeStamp was added\n\t\t// after I encountered a rare, but frequently enough occuring bug\n\t\t// where, when a key is pressed for a longer time so that repeat\n\t\t// keydown events are fired, _very_ occasionally the last keydown\n\t\t// would be fired with the same timeStamp as the keyup event but\n\t\t// the event handler for that last down event was fired AFTER the\n\t\t// keyup event handler, causing the key to appear to be \"stuck\".\n\t\twindow.addEventListener(\"keydown\", evt => {\n\t\t\tconst lastEvent = this.lastEventBase_[evt.keyCode];\n\t\t\tconst wasDown = this.downBase_[evt.keyCode];\n\n\t\t\tif (lastEvent < evt.timeStamp) {\n\t\t\t\tif (! wasDown) { // ignore key repeat events\n\t\t\t\t\tthis.downBase_[evt.keyCode] = 1;\n\t\t\t\t\t++this.halfTransBase_[evt.keyCode];\n\t\t\t\t}\n\t\t\t\tthis.lastEventBase_[evt.keyCode] = evt.timeStamp;\n\t\t\t}\n\n\t\t\tif (! evt.metaKey) {\n\t\t\t\tevt.preventDefault();\n\t\t\t}\n\t\t}, true);\n\n\t\twindow.addEventListener(\"keyup\", evt => {\n\t\t\tthis.downBase_[evt.keyCode] = 0;\n\t\t\t++this.halfTransBase_[evt.keyCode];\n\t\t\tthis.lastEventBase_[evt.keyCode] = evt.timeStamp;\n\n\t\t\tevt.preventDefault();\n\t\t}, true);\n\t}\n\n\tkeyState(kc: Key): ButtonState {\n\t\treturn {\n\t\t\tdown: !!this.downBase_[kc],\n\t\t\thalfTransitionCount: this.halfTransBase_[kc]\n\t\t};\n\t}\n\n\tdown(kc: Key): boolean {\n\t\treturn !!this.downBase_[kc];\n\t}\n\n\thalfTransitions(kc: Key): number {\n\t\treturn this.halfTransBase_[kc];\n\t}\n\n\tpressed(kc: Key): boolean {\n\t\treturn this.downBase_[kc] ? (this.halfTransBase_[kc] > 0) : false;\n\t}\n\n\treleased(kc: Key): boolean {\n\t\treturn !this.downBase_[kc] ? (this.halfTransBase_[kc] > 0) : false;\n\t}\n\n\treset() {\n\t\tthis.keyData_.clear();\n\t}\n\n\tresetPerFrameData() {\n\t\tfill(this.halfTransBase_, 0, this.halfTransBase_.length);\n\t}\n}\n\n\n// -- exported devices\nexport const keyboard: Keyboard = new KeyboardImpl();\n","/**\n * input/mouse - mouse input and capture handling\n * Part of Stardazed\n * (c) 2015-Present by Arthur Langereis - @zenmumbler\n * https://github.com/stardazed/stardazed\n */\n\nimport { UInt8, Float2 } from \"@stardazed/core\";\nimport { FixedMultiArray, MABField, fill } from \"@stardazed/container\";\nimport { vec2 } from \"@stardazed/math\";\nimport { ButtonState } from \"./common\";\n\n// not used yet\nexport const enum MouseControl {\n\tButton0,\n\tButton1,\n\tButton2,\n\tButton3,\n\tButton4,\n\tButton5,\n\tButton6,\n\tButton7,\n\n\tButton8,\n\tButton9,\n\tButton10,\n\tButton11,\n\tButton12,\n\tButton13,\n\tButton14,\n\tButton15,\n\n\tMotionHorizontal,\n\tMotionVertical,\n\n\tWheelHorizontal,\n\tWheelVertical\n}\n\nexport interface Mouse {\n\tbuttonState(index: number): ButtonState;\n\tdown(index: number): boolean;\n\tpressed(index: number): boolean;\n\treleased(index: number): boolean;\n\thalfTransitions(index: number): number;\n\n\treset(): void;\n\tresetPerFrameData(): void;\n\n\tlock(): void;\n\tunlock(): void;\n\n\treadonly position: Float2;\n\treadonly positionDelta: Float2;\n\treadonly wheelDelta: Float2;\n}\n\nclass MouseImpl implements Mouse {\n\tprivate buttonData_: FixedMultiArray;\n\tprivate downBase_: Uint8Array;\n\tprivate halfTransBase_: Uint8Array;\n\tprivate readonly position_: number[];\n\tprivate readonly positionDelta_: number[];\n\tprivate readonly wheelDelta_: number[];\n\n\tconstructor() {\n\t\tconst fields: MABField[] = [\n\t\t\t{ type: UInt8, count: 1 },  // down\n\t\t\t{ type: UInt8, count: 1 },  // halfTransitionCount\n\t\t];\n\t\tthis.buttonData_ = new FixedMultiArray(16, fields);\n\t\tthis.downBase_ = this.buttonData_.indexedFieldView(0) as Uint8Array;\n\t\tthis.halfTransBase_ = this.buttonData_.indexedFieldView(1) as Uint8Array;\n\n\t\tthis.position_ = [0, 0];\n\t\tthis.positionDelta_ = [0, 0];\n\t\tthis.wheelDelta_ = [0, 0];\n\n\t\twindow.addEventListener(\"wheel\", evt => {\n\t\t\tthis.wheelDelta_[0] = evt.deltaX;\n\t\t\tthis.wheelDelta_[1] = evt.deltaY;\n\t\t\tevt.preventDefault();\n\t\t}, true);\n\t\n\t\twindow.addEventListener(\"mousedown\", evt => {\n\t\t\tthis.downBase_[evt.button] = 1;\n\t\t\t++this.halfTransBase_[evt.button];\n\t\t\tevt.preventDefault();\n\t\t}, true);\n\t\n\t\twindow.addEventListener(\"mouseup\", evt => {\n\t\t\tthis.downBase_[evt.button] = 0;\n\t\t\t++this.halfTransBase_[evt.button];\n\t\t\tevt.preventDefault();\n\t\t}, true);\n\t\n\t\twindow.addEventListener(\"contextmenu\", evt => {\n\t\t\t// disable context menu to allow for 2nd-clicks to\n\t\t\t// be handled by the game.\n\t\t\tevt.preventDefault();\n\t\t}, true);\n\n\t\twindow.addEventListener(\"mousemove\", evt => {\n\t\t\tif (document.pointerLockElement) {\n\t\t\t\tthis.positionDelta_[0] = evt.movementX;\n\t\t\t\tthis.positionDelta_[1] = evt.movementY;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.positionDelta_[0] = evt.clientX - this.position_[0];\n\t\t\t\tthis.positionDelta_[1] = evt.clientY - this.position_[1];\n\t\t\t\tthis.position_[0] = evt.clientX;\n\t\t\t\tthis.position_[1] = evt.clientY;\n\t\t\t}\n\t\t}, true);\n\n\t\tdocument.addEventListener(\"pointerlockchange\", _evt => {\n\t\t\t// integrate into mouse capturing logic\n\t\t});\n\n\t\tdocument.addEventListener(\"pointerlockerror\", _evt => {\n\t\t\t// integrate into mouse capturing logic\n\t\t});\n\t}\n\n\tbuttonState(index: number): ButtonState {\n\t\treturn {\n\t\t\tdown: !!this.downBase_[index],\n\t\t\thalfTransitionCount: this.halfTransBase_[index]\n\t\t};\n\t}\n\n\tdown(index: number) {\n\t\treturn !!this.downBase_[index];\n\t}\n\n\tpressed(index: number) {\n\t\treturn this.downBase_[index] ? (this.halfTransBase_[index] > 0) : false;\n\t}\n\n\treleased(index: number): boolean {\n\t\treturn !this.downBase_[index] ? (this.halfTransBase_[index] > 0) : false;\n\t}\n\n\thalfTransitions(index: number) {\n\t\treturn this.halfTransBase_[index];\n\t}\n\n\treset() {\n\t\tthis.buttonData_.clear();\n\t\tvec2.set(this.position_, 0, 0);\n\t\tvec2.set(this.positionDelta_, 0, 0);\n\t\tvec2.set(this.wheelDelta_, 0, 0);\n\t}\n\n\tresetPerFrameData() {\n\t\tfill(this.halfTransBase_, 0, this.halfTransBase_.length);\n\t\tthis.positionDelta_[0] = 0;\n\t\tthis.positionDelta_[1] = 0;\n\t\tthis.wheelDelta_[0] = 0;\n\t\tthis.wheelDelta_[1] = 0;\n\t}\n\n\tlock() {\n\t\tdocument.querySelector(\"canvas\")!.requestPointerLock();\n\t}\n\n\tunlock() {\n\t\tdocument.exitPointerLock();\n\t}\n\n\tget position() {\n\t\treturn this.position_.slice();\n\t}\n\n\tget positionDelta() {\n\t\treturn this.positionDelta_.slice();\n\t}\n\n\tget wheelDelta() {\n\t\treturn this.wheelDelta_.slice();\n\t}\n}\n\n// -- exported devices\nexport const mouse: Mouse = new MouseImpl();\n","/**\n * @stardazed/input - user input device handling\n * Part of Stardazed\n * (c) 2015-Present by Arthur Langereis - @zenmumbler\n * https://github.com/stardazed/stardazed\n */\n\nexport * from \"./common\";\nexport * from \"./keyboard\";\nexport * from \"./mouse\";\n"],"names":[],"mappings":"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"}